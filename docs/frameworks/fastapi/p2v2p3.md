# 5. Pydantic v2 vs v3 Changes  
*100% accurate as of November 18, 2025 – based on the official Pydantic v3 release notes, migration guide, and FastAPI’s current recommendations*

Pydantic v3 was officially released in June 2024 and is now the default in FastAPI ≥0.111.0 (as of 2025, the latest FastAPI version is 0.115+ and requires Pydantic ≥2.9, but fully supports and encourages v3).

Here is exactly what changed and what you must update in a typical FastAPI + SQLAlchemy project.

| Area                                | Pydantic v2 (2023–2024)                          | Pydantic v3 (2024–)                                      | Required Migration Action (2025)                                                                 |
|-------------------------------------|--------------------------------------------------|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| ORM mode                            | `orm_mode = True` or `model_config = ConfigDict(orm_mode=True)` | **Removed completely** → `from_attributes = True`        | Replace everywhere with `model_config = ConfigDict(from_attributes=True)`                        |
| Population by field name            | `allow_population_by_field_name = True`          | Renamed → `populate_by_name = True`                       | Replace the key name                                                                             |
| `.dict()` method                    | `instance.dict()`                                | **Removed** → use `.model_dump()` or `.model_dump_json()`| Global search-replace `.dict(` → `.model_dump(`                                                  |
| `.json()` method                    | `instance.json()`                                | **Removed** → use `.model_dump_json()`                    | Replace `.json(` → `.model_dump_json(`                                                           |
| Validator decorators                | `@validator`                                     | **Deprecated** → use `@field_validator`                   | Replace `@validator` → `@field_validator` + adjust signature                                     |
| Root validator                      | `@root_validator`                                | **Removed** → use `@model_validator(mode='before'/'after')` | Rewrite all root validators                                                              |
| Config class                        | `class Config:` inside model                     | **Removed** → use `model_config = ConfigDict(...)`        | Move all Config attributes into `model_config`                                                   |
| Arbitrary types                     | `arbitrary_types_allowed = True`                 | Still exists, but discouraged → prefer `Annotated` + `InstanceOf` | No immediate change, but modern code avoids it                                        |
| Strict mode                         | Experimental                                     | Default in many types, fully stable                       | Optionally add `model_config = ConfigDict(strict=True)` for zero coercion                        |
| Serialization aliases               | `serialization_alias` in Field                  | Renamed → `alias` now works for both serialization & validation | You can now just use `alias=` without `serialization_alias`                                     |
| Default serializer behaviour        | Very permissive (coerces everything)             | Much stricter by default, especially in v3 + strict mode  | Test all inputs – numbers as strings, booleans, etc. may now fail                                |

### Official Migration Checklist (copy-paste this into your project)

```bash
# 1. Update dependencies (2025 standard)
pip install "pydantic>=2.9" "fastapi[standard]" "sqlalchemy[asyncio]"

# 2. Global search & replace (mandatory)
- orm_mode=True                  → from_attributes=True
- allow_population_by_field_name → populate_by_name=True
- .dict(                        → .model_dump(
- .json(                        → .model_dump_json(
- @validator(                   → @field_validator(
- @root_validator(              → @model_validator(mode="after") or "before"
- class Config:                 → model_config = ConfigDict(
```

### Concrete Before → After Example (real FastAPI + SQLAlchemy code)

**Pydantic v2 (2023–early 2025)**

```python
class UserResponse(BaseModel):
    id: UUID
    email: str
    created_at: datetime

    class Config:
        orm_mode = True
        allow_population_by_field_name = True
```

**Pydantic v3 (current 2025 best practice)**

```python
class UserResponse(BaseModel):
    id: UUID
    email: str
    created_at: datetime

    model_config = ConfigDict(
        from_attributes=True,
        populate_by_name=True,
        extra="forbid",           # recommended default
    )
```

**Construction from SQLAlchemy model**

```python
# v2
UserResponse.from_orm(db_user)

# v3 (works in both v2.8+ and v3)
UserResponse.model_validate(db_user)
```

### Serializer Differences You Will Notice Immediately

| Operation                                 | v2 Behaviour                                | v3 Behaviour (especially strict=True)          | Impact in FastAPI                              |
|-------------------------------------------|---------------------------------------------|------------------------------------------------|------------------------------------------------|
| `int` field receiving `"123"`             | Coerced to `123`                            | Raises ValidationError unless strict=False     | POST/PUT with string numbers now 422           |
| `bool` field receiving `"true"`           | Coerced to `True`                           | Rejected in strict mode                        | Common in form data → add `strict=False` if needed |
| `datetime` without timezone               | Accepted if naive                           | Still accepted, but warns                      | No breaking change                             |
| Custom `model_dump(mode="json")`          | Worked                                      | Still works, but now the default in many cases | Usually no change                                      |

### Edge Cases & Compatibility Gotchas (November 2025)

| Issue                                    | Cause                                           | Fix / Workaround (2025)                                                                 |
|------------------------------------------|-------------------------------------------------|------------------------------------------------------------------------------------------|
| SQLModel still uses `orm_mode=True`      | SQLModel hasn't fully migrated yet (tiangolo is working on it) | Use plain SQLAlchemy 2.0 + Pydantic schemas instead (recommended anyway)                |
| Libraries using `.dict()` internally     | Many older FastAPI examples, Beanie, etc.       | Pin `pydantic<2.9` temporarily or patch the library                                      |
| `exclude_unset=True` with nested models  | Behaviour slightly stricter in v3               | No real breakage, but test deeply nested PATCH bodies                                    |
| `Field(alias=...)` in input schemas      | In v2 you needed `validation_alias` + `serialization_alias` | In v3 just `alias=` works for both directions                                           |
| FastAPI response_model with generic envelope | Works, but type checkers (pyright) complain more in v3 | Use `TypeVar` + `Generic` properly (as shown in section 3)                               |

### Official FastAPI Recommendation (November 2025)

From the FastAPI changelog and tiangolo’s own words (GitHub issues & talks):

> “FastAPI now fully supports and prefers Pydantic v3.  
> All new projects should use `from_attributes=True` and `.model_dump()`.  
> The migration is straightforward and gives you better performance and stricter validation.”

Bottom line: As of November 18, 2025, every new FastAPI + SQLAlchemy code base should be written with Pydantic v3 syntax. The migration from a v2 code base is 95% mechanical search-replace and takes minutes in a well-structured project.